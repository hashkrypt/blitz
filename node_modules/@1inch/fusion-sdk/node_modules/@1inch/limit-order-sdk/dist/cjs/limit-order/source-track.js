"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "injectTrackCode", {
    enumerable: true,
    get: function() {
        return injectTrackCode;
    }
});
var _byteutils = require("@1inch/byte-utils");
var _ethers = require("ethers");
var TRACK_CODE_MASK = new _byteutils.BitMask(224n, 256n);
function getTrackCodeForSource(source) {
    if (!(0, _byteutils.isHexString)(source)) {
        return createId(source);
    }
    if (source.length === 10) {
        return BigInt(source);
    }
    if (source.length === 66) {
        return BigInt(source.substring(0, 10));
    }
    return createId(source);
}
function createId(source) {
    return BigInt((0, _byteutils.add0x)((0, _ethers.id)(source).slice(0, 10)));
}
function injectTrackCode(salt, source) {
    var track = source ? getTrackCodeForSource(source) : 0n;
    return new _byteutils.BN(salt).setMask(TRACK_CODE_MASK, track).value;
}
